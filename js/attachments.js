var attachments_button_label_updater=null;var attachments_button_label="Attach File";var attachments_asset=null;var attachments_hijacked_thickbox=false;function init_attachments_sortable(){if(jQuery("div#attachments-list ul:data(sortable)").length==0&&jQuery("div#attachments-list ul li").length>0){jQuery("div#attachments-list ul").sortable({containment:"parent",stop:function(e,ui){jQuery("#attachments-list ul li").each(function(i,id){jQuery(this).find("input.attachment_order").val(i+1);});}});}};function attachments_handle_attach(_1,_2,id,_3){attachment_index=jQuery("li.attachments-file",top.document).length;new_attachments="";attachment_name=_1;attachment_caption=_2;attachment_id=id;attachment_thumb=_3;attachment_index++;new_attachments+="<li class=\"attachments-file\">";new_attachments+="<h2><a href=\"#\" class=\"attachment-handle\"><span class=\"attachment-handle-icon\"><img src=\""+attachments_base+"/images/handle.gif\" alt=\"Drag\" /></span></a><span class=\"attachment-name\">"+attachment_name+"</span><span class=\"attachment-delete\"><a href=\"#\">Delete</a></span></h2>";new_attachments+="<div class=\"attachments-fields\">";new_attachments+="<div class=\"textfield\" id=\"field_attachment_title_"+attachment_index+"\"><label for=\"attachment_title_"+attachment_index+"\">Title</label><input type=\"text\" id=\"attachment_title_"+attachment_index+"\" name=\"attachment_title_"+attachment_index+"\" value=\""+attachment_name+"\" size=\"20\" /></div>";new_attachments+="<div class=\"textfield\" id=\"field_attachment_caption_"+attachment_index+"\"><label for=\"attachment_caption_"+attachment_index+"\">Caption</label><input type=\"text\" id=\"attachment_caption_"+attachment_index+"\" name=\"attachment_caption_"+attachment_index+"\" value=\""+attachment_caption+"\" size=\"20\" /></div>";new_attachments+="</div>";new_attachments+="<div class=\"attachments-data\">";new_attachments+="<input type=\"hidden\" name=\"attachment_id_"+attachment_index+"\" id=\"attachment_id_"+attachment_index+"\" value=\""+attachment_id+"\" />";new_attachments+="<input type=\"hidden\" class=\"attachment_order\" name=\"attachment_order_"+attachment_index+"\" id=\"attachment_order_"+attachment_index+"\" value=\""+attachment_index+"\" />";new_attachments+="</div>";new_attachments+="<div class=\"attachment-thumbnail\"><span class=\"attachments-thumbnail\">";new_attachments+="<img src=\""+attachment_thumb+"\" alt=\"Thumbnail\" />";new_attachments+="</span></div>";new_attachments+="</li>";jQuery("div#attachments-list ul",top.document).append(new_attachments);if(jQuery("#attachments-list li",top.document).length>0){jQuery("#attachments-list",top.document).show();}};jQuery(document).ready(function(){if(typeof send_to_editor==="function"){var _4=send_to_editor;send_to_editor=function(_5){clearInterval(attachments_button_label_updater);if(attachments_hijacked_thickbox){attachments_hijacked_thickbox=false;}else{_4(_5);}};}
function _6(){if(attachments_hijacked_thickbox){jQuery("#TB_iframeContent").contents().find("td.savesend input").unbind("click").click(function(e){theparent=jQuery(this).parent().parent().parent();jQuery(this).after("<span class=\"attachments-attached\">Attached!</span>");thetitle=theparent.find("tr.post_title td.field input").val();thecaption=theparent.find("tr.post_excerpt td.field input").val();theid=theparent.find("td.imgedit-response").attr("id").replace("imgedit-response-","");thethumb=theparent.parent().parent().find("img.pinkynail").attr("src");attachments_handle_attach(thetitle,thecaption,theid,thethumb);theparent.find("span.attachments-attached").delay(1000).fadeOut("fast");return false;});if(jQuery("#TB_iframeContent").contents().find(".media-item .savesend input[type=submit], #insertonlybutton").length){jQuery("#TB_iframeContent").contents().find(".media-item .savesend input[type=submit], #insertonlybutton").val(attachments_button_label);}
if(jQuery("#TB_iframeContent").contents().find("#tab-type_url").length){jQuery("#TB_iframeContent").contents().find("#tab-type_url").hide();}
if(jQuery("#TB_iframeContent").contents().find("tr.post_title").length){jQuery("#TB_iframeContent").contents().find("tr.image-size input[value=\"full\"]").prop("checked",true);jQuery("#TB_iframeContent").contents().find("tr.post_title,tr.image_alt,tr.post_excerpt,tr.image-size,tr.post_content,tr.url,tr.align,tr.submit>td>a.del-link").hide();}}
if(jQuery("#TB_iframeContent").contents().length==0&&attachments_hijacked_thickbox){clearInterval(attachments_button_label_updater);attachments_hijacked_thickbox=false;}};jQuery("a#attachments-thickbox").live("click",function(_7){var _8=jQuery(this).attr("href"),_9=jQuery(window).width(),H=jQuery(window).height(),W=(720<_9)?720:_9;if(!_8){return;}
_8=_8.replace(/&width=[0-9]+/g,"");_8=_8.replace(/&height=[0-9]+/g,"");jQuery(this).attr("href",_8+"&width="+(W-80)+"&height="+(H-85));attachments_hijacked_thickbox=true;attachments_button_label_updater=setInterval(_6,500);tb_show("Attach a file",_7.target.href,false);return false;});if(jQuery("div#attachments-list li").length==0){jQuery("#attachments-list").hide();}
jQuery("span.attachment-delete a").live("click",function(){attachment_parent=jQuery(this).parent().parent().parent();attachment_parent.slideUp(function(){attachment_parent.remove();jQuery("#attachments-list ul li").each(function(i,id){jQuery(this).find("input.attachment_order").val(i+1);});if(jQuery("div#attachments-list li").length==0){jQuery("#attachments-list").slideUp(function(){jQuery("#attachments-list").hide();});}});return false;});setInterval("init_attachments_sortable()",500);});